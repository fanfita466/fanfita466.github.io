<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotmail Manager Pro - Bandeja Integrada</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== ESTILOS COMPLETOS ===== */
        :root {
            --primary: #0078d4;
            --secondary: #00bcf2;
            --success: #107c10;
            --danger: #d13438;
            --warning: #ffb900;
            --dark: #201f1e;
            --light: #f3f2f1;
            --sidebar: #2d2c2c;
            --outlook-bg: #f2f2f2;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background: var(--primary);
            min-height: 100vh;
        }
        
        /* ===== LOGIN ===== */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0078d4 0%, #00bcf2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        
        .login-container {
            background: white;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        .password-input {
            width: 100%;
            padding: 15px;
            margin: 20px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        
        /* ===== LAYOUT PRINCIPAL ===== */
        .dashboard {
            display: none;
            width: 100%;
            height: 100vh;
            background: white;
        }
        
        /* Header */
        .top-bar {
            background: var(--dark);
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo i {
            font-size: 1.8rem;
            color: var(--secondary);
        }
        
        .user-menu {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        /* Layout Principal */
        .main-layout {
            display: flex;
            height: calc(100vh - 70px);
        }
        
        /* Sidebar de Cuentas */
        .accounts-sidebar {
            width: 350px;
            background: var(--sidebar);
            color: white;
            border-right: 1px solid rgba(255,255,255,0.1);
            display: flex;
            flex-direction: column;
        }
        
        .accounts-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .upload-btn {
            width: 100%;
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 15px;
        }
        
        .accounts-list {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }
        
        .account-item {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid transparent;
        }
        
        .account-item:hover {
            background: rgba(255,255,255,0.1);
            border-left-color: var(--secondary);
        }
        
        .account-item.active {
            background: rgba(0, 120, 212, 0.2);
            border-left-color: var(--primary);
        }
        
        .account-email {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .account-status {
            font-size: 12px;
            color: var(--success);
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* Área Principal - Bandeja de Outlook */
        .main-area {
            flex: 1;
            background: var(--outlook-bg);
            display: flex;
            flex-direction: column;
        }
        
        /* Header de Outlook */
        .outlook-header {
            background: white;
            padding: 15px 30px;
            border-bottom: 1px solid #e1dfdd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .current-account {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .account-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        /* Menú de Outlook */
        .outlook-menu {
            background: white;
            padding: 10px 30px;
            border-bottom: 1px solid #e1dfdd;
            display: flex;
            gap: 30px;
        }
        
        .menu-item {
            padding: 10px 0;
            color: #616161;
            cursor: pointer;
            position: relative;
            font-weight: 600;
        }
        
        .menu-item.active {
            color: var(--primary);
        }
        
        .menu-item.active:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--primary);
        }
        
        /* Bandeja de Correos */
        .inbox-container {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        /* Lista de Emails */
        .emails-list {
            width: 350px;
            background: white;
            border-right: 1px solid #e1dfdd;
            overflow-y: auto;
        }
        
        .email-list-item {
            padding: 20px;
            border-bottom: 1px solid #f3f2f1;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .email-list-item:hover {
            background: #f8f9fa;
        }
        
        .email-list-item.selected {
            background: #edf6ff;
            border-left: 4px solid var(--primary);
        }
        
        .email-sender {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 5px;
        }
        
        .email-subject {
            color: #323130;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .email-preview {
            color: #605e5c;
            font-size: 14px;
            margin-bottom: 10px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .email-date {
            color: #8a8886;
            font-size: 12px;
            text-align: right;
        }
        
        /* Vista de Email */
        .email-viewer {
            flex: 1;
            background: white;
            padding: 30px;
            overflow-y: auto;
        }
        
        .email-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e1dfdd;
        }
        
        .email-subject-large {
            font-size: 24px;
            color: #323130;
            margin-bottom: 15px;
        }
        
        .email-from {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .sender-avatar {
            width: 40px;
            height: 40px;
            background: #d83b01;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .email-body {
            line-height: 1.6;
            color: #323130;
            font-size: 15px;
        }
        
        /* Folders (Carpetas) */
        .folders-sidebar {
            width: 200px;
            background: white;
            border-right: 1px solid #e1dfdd;
            padding: 20px;
        }
        
        .folder-item {
            padding: 12px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 5px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .folder-item:hover {
            background: #f3f2f1;
        }
        
        .folder-item.active {
            background: #edf6ff;
            color: var(--primary);
            font-weight: 600;
        }
        
        .folder-badge {
            margin-left: auto;
            background: #edebe9;
            color: #323130;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
        }
        
        /* Botones de acción */
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            background: #f3f2f1;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .action-btn:hover {
            background: #edebe9;
        }
        
        /* Modal para cargar archivo */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 10001;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
        }
        
        /* Notificaciones */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 10002;
            transform: translateX(150%);
            transition: transform 0.3s ease;
            border-left: 4px solid var(--primary);
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .accounts-sidebar {
                width: 300px;
            }
            
            .emails-list {
                width: 300px;
            }
        }
        
        @media (max-width: 992px) {
            .folders-sidebar {
                display: none;
            }
        }
        
        @media (max-width: 768px) {
            .accounts-sidebar {
                width: 100%;
                height: 40vh;
            }
            
            .main-layout {
                flex-direction: column;
            }
            
            .main-area {
                height: 60vh;
            }
            
            .emails-list {
                width: 100%;
                height: 40vh;
            }
            
            .email-viewer {
                display: none;
            }
            
            .email-viewer.active {
                display: block;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 1000;
                background: white;
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-screen" id="loginScreen">
        <div class="login-container">
            <div style="margin-bottom: 30px;">
                <i class="fab fa-microsoft" style="font-size: 4rem; color: var(--primary);"></i>
                <h1 style="margin: 15px 0 5px 0;">Hotmail Manager Pro</h1>
                <p style="color: #666;">Bandeja de correo integrada</p>
            </div>
            
            <input type="password" 
                   id="passwordInput" 
                   class="password-input" 
                   placeholder="Clave de acceso: 30305090"
                   onkeypress="if(event.key === 'Enter') login()">
            
            <button onclick="login()" 
                    style="width: 100%; background: var(--primary); color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-size: 16px;">
                <i class="fas fa-sign-in-alt"></i> Acceder al Sistema
            </button>
        </div>
    </div>
    
    <!-- Dashboard Principal -->
    <div class="dashboard" id="dashboard">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="logo">
                <i class="fab fa-microsoft"></i>
                <div>
                    <h2>Hotmail Manager Pro</h2>
                    <p style="font-size: 12px; opacity: 0.8;">Bandeja de correo completa integrada</p>
                </div>
            </div>
            
            <div class="user-menu">
                <div style="text-align: right;">
                    <div style="font-weight: 600;">Propietario Autorizado</div>
                    <div style="font-size: 12px; opacity: 0.8;" id="sessionTimer">Sesión activa</div>
                </div>
                <button onclick="logout()" 
                        style="background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 8px 15px; border-radius: 5px; cursor: pointer;">
                    <i class="fas fa-sign-out-alt"></i> Salir
                </button>
            </div>
        </div>
        
        <!-- Layout Principal -->
        <div class="main-layout">
            <!-- Sidebar de Cuentas -->
            <div class="accounts-sidebar">
                <div class="accounts-header">
                    <button class="upload-btn" onclick="showUploadModal()">
                        <i class="fas fa-file-upload"></i> Cargar Archivo TXT
                    </button>
                    <button class="upload-btn" onclick="loadSampleData()" style="background: var(--success);">
                        <i class="fas fa-download"></i> Cargar Datos de Ejemplo
                    </button>
                </div>
                
                <div class="accounts-list" id="accountsList">
                    <!-- Las cuentas aparecerán aquí -->
                </div>
            </div>
            
            <!-- Área Principal - Outlook -->
            <div class="main-area">
                <!-- Header de Outlook -->
                <div class="outlook-header" id="outlookHeader" style="display: none;">
                    <div class="current-account">
                        <div class="account-avatar" id="currentAvatar">M</div>
                        <div>
                            <div style="font-weight: 600;" id="currentEmail">Selecciona una cuenta</div>
                            <div style="font-size: 12px; color: #666;" id="accountInfo">0 correos no leídos</div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="action-btn">
                            <i class="fas fa-redo"></i> Actualizar
                        </button>
                        <button class="action-btn">
                            <i class="fas fa-cog"></i> Configuración
                        </button>
                    </div>
                </div>
                
                <!-- Menú de Outlook -->
                <div class="outlook-menu" id="outlookMenu" style="display: none;">
                    <div class="menu-item active" onclick="showFolder('inbox')">
                        <i class="fas fa-inbox"></i> Bandeja de entrada
                        <span class="folder-badge" id="inboxCount">0</span>
                    </div>
                    <div class="menu-item" onclick="showFolder('sent')">
                        <i class="fas fa-paper-plane"></i> Enviados
                        <span class="folder-badge" id="sentCount">0</span>
                    </div>
                    <div class="menu-item" onclick="showFolder('drafts')">
                        <i class="fas fa-file"></i> Borradores
                        <span class="folder-badge" id="draftsCount">0</span>
                    </div>
                    <div class="menu-item" onclick="showFolder('spam')">
                        <i class="fas fa-ban"></i> Spam
                        <span class="folder-badge" id="spamCount">0</span>
                    </div>
                    <div class="menu-item" onclick="showFolder('trash')">
                        <i class="fas fa-trash"></i> Eliminados
                        <span class="folder-badge" id="trashCount">0</span>
                    </div>
                </div>
                
                <!-- Contenedor de Bandeja -->
                <div class="inbox-container" id="inboxContainer" style="display: none;">
                    <!-- Sidebar de Carpetas -->
                    <div class="folders-sidebar">
                        <div class="folder-item active" onclick="showFolder('inbox')">
                            <i class="fas fa-inbox"></i> Bandeja de entrada
                            <span class="folder-badge" id="folderInboxCount">0</span>
                        </div>
                        <div class="folder-item" onclick="showFolder('starred')">
                            <i class="fas fa-star"></i> Destacados
                            <span class="folder-badge">0</span>
                        </div>
                        <div class="folder-item" onclick="showFolder('important')">
                            <i class="fas fa-exclamation-circle"></i> Importantes
                            <span class="folder-badge">0</span>
                        </div>
                        <div class="folder-item" onclick="showFolder('sent')">
                            <i class="fas fa-paper-plane"></i> Enviados
                            <span class="folder-badge" id="folderSentCount">0</span>
                        </div>
                        <div class="folder-item" onclick="showFolder('drafts')">
                            <i class="fas fa-file"></i> Borradores
                            <span class="folder-badge" id="folderDraftsCount">0</span>
                        </div>
                        <div class="folder-item" onclick="showFolder('spam')">
                            <i class="fas fa-ban"></i> Spam
                            <span class="folder-badge" id="folderSpamCount">0</span>
                        </div>
                        <div class="folder-item" onclick="showFolder('trash')">
                            <i class="fas fa-trash"></i> Papelera
                            <span class="folder-badge" id="folderTrashCount">0</span>
                        </div>
                    </div>
                    
                    <!-- Lista de Emails -->
                    <div class="emails-list" id="emailsList">
                        <!-- Los emails aparecerán aquí -->
                    </div>
                    
                    <!-- Vista de Email -->
                    <div class="email-viewer" id="emailViewer">
                        <div class="email-header">
                            <h2 class="email-subject-large" id="emailSubject">Selecciona un correo</h2>
                            <div class="email-from">
                                <div class="sender-avatar" id="senderAvatar">S</div>
                                <div>
                                    <div style="font-weight: 600;" id="senderName">Remitente</div>
                                    <div style="color: #666; font-size: 14px;" id="senderEmail">correo@ejemplo.com</div>
                                </div>
                                <div style="margin-left: auto; color: #666; font-size: 14px;" id="emailDate">Fecha</div>
                            </div>
                        </div>
                        
                        <div class="email-body" id="emailBody">
                            <p>Selecciona un correo de la lista para ver su contenido completo.</p>
                            <p>Aquí podrás leer todos los detalles del email seleccionado, incluyendo archivos adjuntos, formato y toda la información relevante.</p>
                        </div>
                        
                        <!-- Adjuntos -->
                        <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e1dfdd;">
                            <h4 style="margin-bottom: 15px;">
                                <i class="fas fa-paperclip"></i> Archivos adjuntos
                            </h4>
                            <div id="emailAttachments">
                                <!-- Los archivos adjuntos aparecerán aquí -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Vista vacía inicial -->
                <div id="emptyView" style="flex: 1; display: flex; justify-content: center; align-items: center; color: #666;">
                    <div style="text-align: center; padding: 40px;">
                        <i class="fab fa-microsoft" style="font-size: 4rem; color: #e1dfdd; margin-bottom: 20px;"></i>
                        <h3 style="margin-bottom: 10px;">Selecciona una cuenta Hotmail</h3>
                        <p>Elige una cuenta de la lista para ver su bandeja de correo completa</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para cargar archivo -->
    <div class="modal" id="uploadModal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px;">
                <i class="fas fa-file-upload"></i> Cargar Archivo de Hotmails
            </h3>
            
            <p style="margin-bottom: 15px; color: #666;">
                Selecciona un archivo TXT con tus cuentas Hotmail/Outlook
            </p>
            
            <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin: 20px 0;">
                <p style="font-weight: 600; margin-bottom: 10px;">Formato aceptado:</p>
                <code style="color: var(--primary); font-family: monospace; display: block; padding: 10px; background: white; border-radius: 5px;">
                    correo@hotmail.com:contraseña123<br>
                    usuario@outlook.com|clave456<br>
                    cuenta@live.com password789
                </code>
            </div>
            
            <input type="file" id="fileInput" accept=".txt" style="display: none;" onchange="handleFileUpload(event)">
            
            <div style="border: 2px dashed #ddd; border-radius: 10px; padding: 40px 20px; text-align: center; margin: 20px 0; cursor: pointer;" 
                 onclick="document.getElementById('fileInput').click()">
                <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: #666; margin-bottom: 15px;"></i>
                <h4>Haz clic para seleccionar archivo</h4>
                <p style="color: #666;">Solo archivos .txt</p>
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button onclick="closeModal()" 
                        style="flex: 1; background: #666; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer;">
                    <i class="fas fa-times"></i> Cancelar
                </button>
                <button onclick="loadSampleData()" 
                        style="flex: 1; background: var(--success); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer;">
                    <i class="fas fa-download"></i> Usar Ejemplo
                </button>
            </div>
        </div>
    </div>
    
    <!-- Notificación -->
    <div class="notification" id="notification">
        <div style="display: flex; align-items: center; gap: 15px;">
            <i class="fas fa-info-circle" id="notificationIcon"></i>
            <div>
                <h4 id="notificationTitle" style="margin: 0 0 5px 0;">Notificación</h4>
                <p id="notificationMessage" style="margin: 0; color: #666;">Mensaje de notificación</p>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // ===== CONFIGURACIÓN =====
        const MASTER_PASSWORD = "30305090";
        let accounts = [];
        let currentAccount = null;
        let currentFolder = 'inbox';
        let emails = {
            inbox: [],
            sent: [],
            drafts: [],
            spam: [],
            trash: [],
            starred: [],
            important: []
        };
        
        // ===== FUNCIONES DE LOGIN =====
        function login() {
            const password = document.getElementById('passwordInput').value;
            
            if (password === MASTER_PASSWORD) {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                showNotification('success', 'Acceso concedido', 'Bienvenido al gestor de Hotmails');
                loadSampleData();
            } else {
                alert('Clave incorrecta. La clave es: 30305090');
                document.getElementById('passwordInput').value = '';
                document.getElementById('passwordInput').focus();
            }
        }
        
        function logout() {
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('passwordInput').value = '';
            showNotification('info', 'Sesión cerrada', 'Has salido del sistema');
        }
        
        // ===== GESTIÓN DE CUENTAS =====
        function showUploadModal() {
            document.getElementById('uploadModal').style.display = 'flex';
        }
        
        function closeModal() {
            document.getElementById('uploadModal').style.display = 'none';
        }
        
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const content = e.target.result;
                    parseAccountsFile(content);
                    closeModal();
                    showNotification('success', 'Archivo cargado', `${accounts.length} cuentas encontradas`);
                } catch (error) {
                    showNotification('error', 'Error', 'Formato de archivo incorrecto');
                }
            };
            reader.readAsText(file);
        }
        
        function parseAccountsFile(content) {
            const lines = content.split('\n');
            accounts = [];
            
            lines.forEach((line, index) => {
                line = line.trim();
                if (!line) return;
                
                let email, password;
                
                // Detectar formato
                if (line.includes(':')) {
                    const parts = line.split(':');
                    if (parts.length >= 2) {
                        email = parts[0].trim();
                        password = parts.slice(1).join(':').trim();
                    }
                } else if (line.includes('|')) {
                    const parts = line.split('|');
                    if (parts.length >= 2) {
                        email = parts[0].trim();
                        password = parts.slice(1).join('|').trim();
                    }
                } else if (line.includes(' ')) {
                    const parts = line.split(' ');
                    if (parts.length >= 2) {
                        email = parts[0].trim();
                        password = parts.slice(1).join(' ').trim();
                    }
                }
                
                if (email && password) {
                    accounts.push({
                        id: index + 1,
                        email: email,
                        password: password,
                        verified: true,
                        provider: getProvider(email),
                        unread: Math.floor(Math.random() * 20),
                        total: Math.floor(Math.random() * 100) + 50,
                        lastCheck: new Date().toLocaleTimeString()
                    });
                }
            });
            
            updateAccountsList();
        }
        
        function getProvider(email) {
            if (email.includes('@hotmail.')) return 'Hotmail';
            if (email.includes('@outlook.')) return 'Outlook';
            if (email.includes('@live.')) return 'Live';
            if (email.includes('@msn.')) return 'MSN';
            return 'Microsoft';
        }
        
        function updateAccountsList() {
            const container = document.getElementById('accountsList');
            
            if (accounts.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px; color: rgba(255,255,255,0.5);">
                        <i class="fas fa-inbox" style="font-size: 2rem; margin-bottom: 15px;"></i>
                        <p>No hay cuentas cargadas</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            accounts.forEach((account, index) => {
                const firstLetter = account.email.charAt(0).toUpperCase();
                const isActive = currentAccount && currentAccount.email === account.email;
                
                html += `
                    <div class="account-item ${isActive ? 'active' : ''}" onclick="selectAccount(${index})">
                        <div class="account-email">${account.email}</div>
                        <div class="account-status">
                            <i class="fas fa-check-circle"></i> Verificado • ${account.unread} no leídos
                        </div>
                        <div style="font-size: 11px; color: rgba(255,255,255,0.6); margin-top: 5px;">
                            Última verificación: ${account.lastCheck}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function selectAccount(index) {
            currentAccount = accounts[index];
            
            // Actualizar UI
            document.getElementById('currentAvatar').textContent = currentAccount.email.charAt(0).toUpperCase();
            document.getElementById('currentEmail').textContent = currentAccount.email;
            document.getElementById('accountInfo').textContent = `${currentAccount.unread} correos no leídos • ${currentAccount.total} total`;
            
            // Mostrar Outlook
            document.getElementById('outlookHeader').style.display = 'flex';
            document.getElementById('outlookMenu').style.display = 'flex';
            document.getElementById('inboxContainer').style.display = 'flex';
            document.getElementById('emptyView').style.display = 'none';
            
            // Actualizar lista de cuentas
            updateAccountsList();
            
            // Cargar emails de ejemplo
            generateSampleEmails();
            
            // Mostrar bandeja de entrada
            showFolder('inbox');
            
            showNotification('info', 'Cuenta seleccionada', `Mostrando bandeja de ${currentAccount.email}`);
        }
        
        // ===== GESTIÓN DE EMAILS =====
        function generateSampleEmails() {
            // Resetear emails
            emails = {
                inbox: [],
                sent: [],
                drafts: [],
                spam: [],
                trash: [],
                starred: [],
                important: []
            };
            
            const senders = [
                { name: 'SAT México', email: 'notificaciones@sat.gob.mx', color: '#d83b01' },
                { name: 'Microsoft Support', email: 'support@microsoft.com', color: '#0078d4' },
                { name: 'Banco Nacional', email: 'notificaciones@bancanacional.com', color: '#107c10' },
                { name: 'Amazon', email: 'no-reply@amazon.com', color: '#ff9900' },
                { name: 'Departamento de Recursos Humanos', email: 'rrhh@empresa.com', color: '#7719aa' },
                { name: 'Netflix', email: 'info@netflix.com', color: '#e50914' },
                { name: 'Google', email: 'no-reply@google.com', color: '#4285f4' },
                { name: 'LinkedIn', email: 'updates@linkedin.com', color: '#0077b5' }
            ];
            
            const subjects = [
                'Factura pendiente de pago',
                'Actualización de seguridad requerida',
                'Contrato por firmar - Urgente',
                'Recordatorio de pago vencido',
                'Confirmación de pedido #2024-001',
                'Alerta de actividad inusual en tu cuenta',
                'Nueva factura adjunta',
                'Renovación de contrato anual',
                'Documentos importantes para revisión',
                'Oferta especial - Descuento exclusivo',
                'Confirmación de reunión',
                'Estado de cuenta actualizado',
                'Verificación de identidad requerida',
                'Promoción especial para clientes',
                'Recordatorio de cita médica'
            ];
            
            const bodies = [
                'Estimado cliente, le informamos que tiene una factura pendiente de pago. Por favor, realice el pago a la brevedad para evitar recargos.',
                'Hemos detectado actividad inusual en su cuenta. Por seguridad, le recomendamos cambiar su contraseña inmediatamente.',
                'Adjunto encontrará el contrato para su revisión y firma. Por favor, revíselo cuidadosamente antes de proceder.',
                'Su pedido ha sido confirmado y está en proceso de preparación. Recibirá una notificación cuando sea enviado.',
                'Su suscripción se renovará automáticamente en los próximos días. Si desea cancelar, por favor hágalo antes de la fecha de renovación.',
                'Le enviamos los documentos solicitados para su revisión. Por favor, confirme recepción.',
                'Tiene una cita programada para mañana. Por favor, confirme su asistencia.',
                'Su cuenta ha sido actualizada exitosamente. Ahora tiene acceso a todas las funcionalidades premium.',
                'Hemos aplicado un descuento especial a su última compra. Adjunto encontrará la factura actualizada.',
                'Por favor, complete la encuesta de satisfacción para ayudarnos a mejorar nuestro servicio.'
            ];
            
            // Generar emails para cada carpeta
            for (let folder in emails) {
                const count = folder === 'inbox' ? 15 : 
                             folder === 'sent' ? 8 : 
                             folder === 'spam' ? 6 : 
                             folder === 'trash' ? 4 : 3;
                
                for (let i = 0; i < count; i++) {
                    const sender = senders[Math.floor(Math.random() * senders.length)];
                    const daysAgo = Math.floor(Math.random() * 30);
                    const date = new Date(Date.now() - daysAgo * 24 * 60 * 60 * 1000);
                    const hasAttachment = Math.random() > 0.5;
                    const isUnread = folder === 'inbox' && Math.random() > 0.5 && i < 5;
                    const isStarred = Math.random() > 0.7;
                    const isImportant = Math.random() > 0.6;
                    
                    emails[folder].push({
                        id: `${folder}_${i}`,
                        folder: folder,
                        sender: sender,
                        subject: subjects[Math.floor(Math.random() * subjects.length)],
                        body: bodies[Math.floor(Math.random() * bodies.length)],
                        date: date,
                        hasAttachment: hasAttachment,
                        isUnread: isUnread,
                        isStarred: isStarred,
                        isImportant: isImportant,
                        attachments: hasAttachment ? [
                            { name: `documento_${i}.pdf`, size: `${(Math.random() * 5 + 0.5).toFixed(1)} MB` },
                            { name: `factura_${i}.pdf`, size: `${(Math.random() * 3 + 0.3).toFixed(1)} MB` }
                        ] : []
                    });
                }
            }
            
            // Actualizar contadores
            updateFolderCounts();
        }
        
        function updateFolderCounts() {
            document.getElementById('inboxCount').textContent = emails.inbox.length;
            document.getElementById('sentCount').textContent = emails.sent.length;
            document.getElementById('draftsCount').textContent = emails.drafts.length;
            document.getElementById('spamCount').textContent = emails.spam.length;
            document.getElementById('trashCount').textContent = emails.trash.length;
            
            document.getElementById('folderInboxCount').textContent = emails.inbox.length;
            document.getElementById('folderSentCount').textContent = emails.sent.length;
            document.getElementById('folderDraftsCount').textContent = emails.drafts.length;
            document.getElementById('folderSpamCount').textContent = emails.spam.length;
            document.getElementById('folderTrashCount').textContent = emails.trash.length;
        }
        
        function showFolder(folder) {
            currentFolder = folder;
            
            // Actualizar menú activo
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelectorAll('.folder-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Marcar como activo
            const menuItem = Array.from(document.querySelectorAll('.menu-item'))[['inbox', 'sent', 'drafts', 'spam', 'trash'].indexOf(folder)];
            if (menuItem) menuItem.classList.add('active');
            
            const folderItem = document.querySelector(`.folder-item:nth-child(${['inbox', 'starred', 'important', 'sent', 'drafts', 'spam', 'trash'].indexOf(folder) + 1})`);
            if (folderItem) folderItem.classList.add('active');
            
            // Mostrar emails
            displayEmails(emails[folder]);
            
            // Resetear vista de email
            resetEmailView();
        }
        
        function displayEmails(emailList) {
            const container = document.getElementById('emailsList');
            
            if (emailList.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #666;">
                        <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.3;"></i>
                        <h4>No hay correos</h4>
                        <p>Esta carpeta está vacía</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            emailList.forEach((email, index) => {
                const timeAgo = getTimeAgo(email.date);
                const isUnread = email.isUnread && currentFolder === 'inbox';
                
                html += `
                    <div class="email-list-item ${index === 0 ? 'selected' : ''}" onclick="selectEmail('${email.id}')">
                        <div style="display: flex; align-items: flex-start; gap: 10px; margin-bottom: 10px;">
                            <div class="sender-avatar" style="width: 32px; height: 32px; font-size: 14px; background: ${email.sender.color}">
                                ${email.sender.name.charAt(0)}
                            </div>
                            <div style="flex: 1;">
                                <div class="email-sender" style="${isUnread ? 'font-weight: 800; color: #323130;' : ''}">
                                    ${email.sender.name}
                                    ${email.isStarred ? ' <i class="fas fa-star" style="color: #ffb900; font-size: 12px;"></i>' : ''}
                                    ${email.isImportant ? ' <i class="fas fa-exclamation-circle" style="color: #d13438; font-size: 12px;"></i>' : ''}
                                </div>
                                <div class="email-subject" style="${isUnread ? 'font-weight: 700; color: #323130;' : ''}">
                                    ${email.hasAttachment ? '<i class="fas fa-paperclip" style="color: #666; margin-right: 5px; font-size: 12px;"></i>' : ''}
                                    ${email.subject}
                                </div>
                            </div>
                        </div>
                        <div class="email-preview">
                            ${email.body.substring(0, 100)}${email.body.length > 100 ? '...' : ''}
                        </div>
                        <div class="email-date">
                            ${timeAgo}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
            // Seleccionar primer email automáticamente
            if (emailList.length > 0) {
                selectEmail(emailList[0].id);
            }
        }
        
        function selectEmail(emailId) {
            // Buscar el email en todas las carpetas
            let selectedEmail = null;
            for (let folder in emails) {
                const email = emails[folder].find(e => e.id === emailId);
                if (email) {
                    selectedEmail = email;
                    break;
                }
            }
            
            if (!selectedEmail) return;
            
            // Marcar como leído si está en inbox
            if (selectedEmail.isUnread) {
                selectedEmail.isUnread = false;
                if (currentAccount) {
                    currentAccount.unread = Math.max(0, currentAccount.unread - 1);
                    document.getElementById('accountInfo').textContent = `${currentAccount.unread} correos no leídos • ${currentAccount.total} total`;
                }
            }
            
            // Actualizar UI de lista
            document.querySelectorAll('.email-list-item').forEach(item => {
                item.classList.remove('selected');
            });
            event.target.closest('.email-list-item').classList.add('selected');
            
            // Mostrar email
            showEmail(selectedEmail);
        }
        
        function showEmail(email) {
            // Actualizar vista de email
            document.getElementById('emailSubject').textContent = email.subject;
            document.getElementById('senderAvatar').textContent = email.sender.name.charAt(0);
            document.getElementById('senderAvatar').style.background = email.sender.color;
            document.getElementById('senderName').textContent = email.sender.name;
            document.getElementById('senderEmail').textContent = email.sender.email;
            document.getElementById('emailDate').textContent = email.date.toLocaleDateString() + ' ' + email.date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            document.getElementById('emailBody').innerHTML = `
                <p>${email.body}</p>
                <br>
                <p>Para: ${currentAccount ? currentAccount.email : 'usuario@outlook.com'}</p>
                <br>
                <p>Atentamente,<br>${email.sender.name}</p>
            `;
            
            // Mostrar adjuntos
            const attachmentsDiv = document.getElementById('emailAttachments');
            if (email.attachments && email.attachments.length > 0) {
                let attachmentsHtml = '';
                email.attachments.forEach(attachment => {
                    attachmentsHtml += `
                        <div style="display: flex; align-items: center; gap: 15px; padding: 10px; background: #f8f9fa; border-radius: 8px; margin-bottom: 10px;">
                            <i class="fas fa-file-pdf" style="color: #d13438; font-size: 1.5rem;"></i>
                            <div style="flex: 1;">
                                <div style="font-weight: 600;">${attachment.name}</div>
                                <div style="color: #666; font-size: 14px;">${attachment.size}</div>
                            </div>
                            <button style="background: var(--primary); color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 14px;">
                                <i class="fas fa-download"></i> Descargar
                            </button>
                        </div>
                    `;
                });
                attachmentsDiv.innerHTML = attachmentsHtml;
            } else {
                attachmentsDiv.innerHTML = '<p style="color: #666;">No hay archivos adjuntos</p>';
            }
        }
        
        function resetEmailView() {
            document.getElementById('emailSubject').textContent = 'Selecciona un correo';
            document.getElementById('senderAvatar').textContent = 'S';
            document.getElementById('senderAvatar').style.background = '#0078d4';
            document.getElementById('senderName').textContent = 'Remitente';
            document.getElementById('senderEmail').textContent = 'correo@ejemplo.com';
            document.getElementById('emailDate').textContent = 'Fecha';
            document.getElementById('emailBody').innerHTML = `
                <p>Selecciona un correo de la lista para ver su contenido completo.</p>
                <p>Aquí podrás leer todos los detalles del email seleccionado.</p>
            `;
            document.getElementById('emailAttachments').innerHTML = '';
        }
        
        // ===== FUNCIONES DE UTILIDAD =====
        function getTimeAgo(date) {
            const now = new Date();
            const diff = now - date;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);
            
            if (minutes < 60) return `Hace ${minutes} min`;
            if (hours < 24) return `Hace ${hours} h`;
            if (days < 7) return `Hace ${days} d`;
            return date.toLocaleDateString();
        }
        
        function loadSampleData() {
            accounts = [
                {
                    id: 1,
                    email: 'pobapi@outlook.es',
                    password: 'pueblo12',
                    verified: true,
                    provider: 'Outlook',
                    unread: 5,
                    total: 87,
                    lastCheck: 'Hoy 5:08 p.m.'
                },
                {
                    id: 2,
                    email: 'pool-gold@outlook.es',
                    password: 'futbol06',
                    verified: true,
                    provider: 'Outlook',
                    unread: 12,
                    total: 156,
                    lastCheck: 'Hoy 4:30 p.m.'
                },
                {
                    id: 3,
                    email: 'uropenagos7@outlook.es',
                    password: 'juanca90',
                    verified: true,
                    provider: 'Outlook',
                    unread: 3,
                    total: 42,
                    lastCheck: 'Hoy 3:45 p.m.'
                },
                {
                    id: 4,
                    email: 'pompaem_2014@hotmail.com',
                    password: 'paem2014',
                    verified: true,
                    provider: 'Hotmail',
                    unread: 8,
                    total: 203,
                    lastCheck: 'Ayer 2:15 p.m.'
                }
            ];
            
            updateAccountsList();
            showNotification('success', 'Datos de ejemplo', '4 cuentas Hotmail/Outlook cargadas');
            
            // Seleccionar primera cuenta automáticamente
            setTimeout(() => {
                if (accounts.length > 0) {
                    selectAccount(0);
                }
            }, 500);
        }
        
        function showNotification(type, title, message) {
            const notification = document.getElementById('notification');
            const icon = document.getElementById('notificationIcon');
            const titleEl = document.getElementById('notificationTitle');
            const messageEl = document.getElementById('notificationMessage');
            
            // Configurar tipo
            icon.className = 'fas fa-' + 
                (type === 'success' ? 'check-circle' : 
                 type === 'error' ? 'exclamation-circle' : 
                 type === 'warning' ? 'exclamation-triangle' : 'info-circle');
            
            icon.style.color = type === 'success' ? 'var(--success)' : 
                              type === 'error' ? 'var(--danger)' : 
                              type === 'warning' ? 'var(--warning)' : 'var(--primary)';
            
            notification.style.borderLeftColor = type === 'success' ? 'var(--success)' : 
                                                 type === 'error' ? 'var(--danger)' : 
                                                 type === 'warning' ? 'var(--warning)' : 'var(--primary)';
            
            // Configurar contenido
            titleEl.textContent = title;
            messageEl.textContent = message;
            
            // Mostrar
            notification.classList.add('show');
            
            // Ocultar después de 3 segundos
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // ===== INICIALIZACIÓN =====
        document.addEventListener('DOMContentLoaded', function() {
            // Cerrar modal al hacer clic fuera
            document.getElementById('uploadModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });
            
            // Permitir Enter en password
            document.getElementById('passwordInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });
        });
    </script>
</body>
</html>
